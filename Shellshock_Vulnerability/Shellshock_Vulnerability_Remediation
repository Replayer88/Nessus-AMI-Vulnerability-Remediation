# Nessus report shows two entries for shellshock: 77829 and 82581
# Use the command to test for the shellshock vulnerability
# Command will append to the target file and display a line of text 
# System has shellshock if we see the word “Hacked” in the response
curl -A ‘() { :;}; echo Content-Type: text/plain ; echo “” ; echo “” ; echo Hacked ;’ http://localhost/cgi-bin/test.cgi

# An out of date BASH shell is causing the vulnerability
# Find the /cgi-bin/test.cgi script in the directory that web servers will place their files
ls /var/www/cgi-bin
cat /var/www/cgi-bin/test.cgi.

# The first line of the test.cgi file contains a shebang which shows us the absolute path to the BASH interpreter
# Every version of BASH up until 4.3 is affected so check BASH version
/usr/local/bin/bash --version

# Change the shebang from /usr/local/bin/bash to /usr/bin/bash
nano /var/www/cgi-bin/test.cgi

# Run the curl command again to test if shellshock was remediated
# We should no longer see “Hacked” and should instead see “Testing”
curl -A ‘() { :;}; echo Content-Type: text/plain ; echo “” ; echo “” ; echo Hacked ;’ http://localhost/cgi-bin/test.cgi

# Shellshock was remediated
